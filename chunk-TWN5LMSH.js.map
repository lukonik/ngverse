{
  "version": 3,
  "sources": ["projects/ngverse/src/lib/ui/form-field/error.component.ts", "projects/ngverse/src/lib/ui/form-field/form-field-error.registry.ts", "projects/ngverse/src/lib/ui/form-field/form-field.component.ts", "projects/ngverse/src/lib/ui/form-field/form-field.component.html"],
  "sourcesContent": ["import { ChangeDetectionStrategy, Component } from '@angular/core';\n\n@Component({\n  selector: 'app-error',\n  template: '<ng-content></ng-content>',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  host: {\n    class: 'text-sm text-danger',\n  },\n})\nexport class ErrorComponent {}\n", "import { Injectable, signal } from '@angular/core';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype ERROR_TYPE = Record<string, string | ((params: any) => string)>;\n\nconst DEFAULT_ERRORS: Record<string, string> = {\n  required: 'This field is required',\n  email: 'Enter a valid email address',\n  min: 'This field is too short',\n  max: 'This field is too long',\n};\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FormFieldErrorRegistry {\n  private _errors = signal<ERROR_TYPE>(DEFAULT_ERRORS);\n\n  errors = this._errors.asReadonly();\n\n  getMessage(code: string, params?: unknown) {\n    const foundError = this._errors()[code];\n    if (!foundError) {\n      return undefined;\n    }\n    if (foundError instanceof Function) {\n      return foundError(params);\n    }\n    return foundError;\n  }\n\n  addErrors(errors: ERROR_TYPE) {\n    this._errors.set({ ...this._errors(), ...errors });\n  }\n\n  setErrors(errors: ERROR_TYPE) {\n    this._errors.set(errors);\n  }\n}\n", "import {\n  ChangeDetectionStrategy,\n  Component,\n  computed,\n  contentChild,\n  effect,\n  inject,\n  input,\n  OnDestroy,\n  signal,\n} from '@angular/core';\nimport { toObservable } from '@angular/core/rxjs-interop';\nimport {\n  AbstractControl,\n  NgControl,\n  StatusChangeEvent,\n  TouchedChangeEvent,\n  Validators,\n} from '@angular/forms';\nimport { filter, merge, Subscription } from 'rxjs';\nimport { ErrorComponent } from './error.component';\nimport { FormFieldErrorRegistry } from './form-field-error.registry';\n\n@Component({\n  selector: 'app-form-field',\n  imports: [ErrorComponent],\n  templateUrl: './form-field.component.html',\n  styleUrl: './form-field.component.css',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class FormFieldComponent implements OnDestroy {\n  silentErrors = input<string[] | undefined>();\n  showErrors = input<boolean>(true);\n  hideRequiredMarker = input<boolean>(false);\n\n  errors = signal<string[]>([]);\n  invalid = signal(false);\n  touched = signal(false);\n  showCustomErrors = computed(\n    () => !this.showErrors() || this.errors().length === 0\n  );\n\n  hasRequiredValidation = computed(() => {\n    const control = this.ngControl()?.control;\n    if (control) {\n      return (\n        control.hasValidator(Validators.required) ||\n        control.hasValidator(Validators.requiredTrue)\n      );\n    }\n    return false;\n  });\n\n  private ngControl = contentChild(NgControl);\n  private sub: Subscription | undefined;\n  private errorRegistry = inject(FormFieldErrorRegistry);\n  private errorsCodes$ = toObservable(this.errorRegistry.errors);\n  private silentErrors$ = toObservable(this.silentErrors);\n\n  constructor() {\n    effect(() => {\n      const ngControl = this.ngControl();\n      const control = ngControl?.control;\n      if (!control) {\n        this.sub?.unsubscribe();\n        return;\n      }\n\n      const controlEvent = control.events.pipe(\n        filter(\n          (e) =>\n            e instanceof TouchedChangeEvent || e instanceof StatusChangeEvent\n        )\n      );\n      this.sub = merge(\n        controlEvent,\n        this.errorsCodes$,\n        this.silentErrors$\n      ).subscribe(() => {\n        this.touched.set(control.touched);\n        this.invalid.set(control.invalid);\n        this.processErrors(control);\n      });\n    });\n  }\n  private processErrors(control: AbstractControl<unknown>) {\n    const errors: string[] = [];\n    const silentErrors = this.silentErrors();\n    for (const key in control.errors) {\n      const notInSilent = !silentErrors?.includes(key);\n      if (control.errors[key] && notInSilent) {\n        const errorLabel = this.errorRegistry.getMessage(\n          key,\n          control.errors[key]\n        );\n        if (errorLabel !== undefined) {\n          errors.push(errorLabel);\n        }\n      }\n    }\n\n    this.errors.set(errors);\n  }\n\n  ngOnDestroy(): void {\n    this.sub?.unsubscribe();\n  }\n}\n", "<div class=\"relative mb-1.5 flex flex-col gap-1.5 pb-5\">\n  <!-- eslint-disable-next-line @angular-eslint/template/label-has-associated-control -->\n  <label class=\"flex flex-col gap-1.5\">\n    <div class=\"flex items-center gap-1\">\n      <ng-content select=\"app-label\"></ng-content>\n      @if (!hideRequiredMarker() && hasRequiredValidation()) {\n        <span class=\"text-danger\">*</span>\n      }\n    </div>\n    <ng-content></ng-content>\n  </label>\n\n  <div class=\"absolute right-0 bottom-0 left-0 flex flex-col\">\n    @if (invalid() && touched()) {\n      @if (showErrors()) {\n        @for (error of errors(); track $index) {\n          <app-error>{{ error }}</app-error>\n        }\n      }\n      @if (showCustomErrors()) {\n        <ng-content select=\"app-error\"></ng-content>\n      }\n    }\n  </div>\n</div>\n"],
  "mappings": "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",
  "names": []
}
