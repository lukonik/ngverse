{
  "version": 3,
  "sources": ["projects/ngverse/src/lib/ui/icon/icon.registry.ts", "projects/ngverse/src/lib/ui/icon/icon-loader.service.ts", "projects/ngverse/src/lib/ui/icon/icon.component.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class IconRegistry {\n  private readonly icons = new Map<string, string>();\n\n  addIcon(name: string, url: string) {\n    this.icons.set(name, url);\n  }\n\n  getUrl(name: string) {\n    return this.icons.get(name);\n  }\n}\n", "import { inject, Injectable, PLATFORM_ID } from '@angular/core';\n\nimport { finalize, map, Observable, of, shareReplay, tap } from 'rxjs';\n\nimport { isPlatformBrowser } from '@angular/common';\nimport { HttpClient } from '@angular/common/http';\nimport { IconRegistry } from './icon.registry';\n\nfunction createDomParser() {\n  const platformId = inject(PLATFORM_ID);\n  if (isPlatformBrowser(platformId)) {\n    return new DOMParser();\n  }\n  return null;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class IconLoaderService {\n  private readonly _iconRegistry = inject(IconRegistry);\n  private readonly http = inject(HttpClient);\n  private readonly _domParser = createDomParser();\n  private readonly _iconLoader = new Map<\n    string,\n    Observable<HTMLElement | null>\n  >();\n  private readonly _iconCache = new Map<string, HTMLElement>();\n\n  load(name: string) {\n    const url = this._iconRegistry.getUrl(name);\n\n    if (!url) {\n      throw new Error(\n        `Icon with name ${name} not found. Please use IconRegistry.addSvgIcon() to add it.`\n      );\n    }\n    const cachedIcon = this._iconCache.get(url);\n\n    if (cachedIcon) {\n      return of(cachedIcon.cloneNode(true) as HTMLElement);\n    }\n    const iconIsLoading = this._iconLoader.get(url);\n    if (iconIsLoading) {\n      return iconIsLoading.pipe(\n        map((svg) => svg?.cloneNode(true) as HTMLElement)\n      );\n    }\n\n    return this.fetch(url);\n  }\n\n  private fetch(url: string) {\n    const http$ = this.http\n      .get(url, {\n        responseType: 'text',\n      })\n      .pipe(map((svg) => this.stringToSvg(svg)))\n      .pipe(\n        tap((svg) => {\n          if (svg) {\n            this._iconCache.set(url, svg);\n          }\n        })\n      )\n      .pipe(finalize(() => this._iconLoader.delete(url)))\n      .pipe(shareReplay(1));\n    this._iconLoader.set(url, http$);\n    return http$;\n  }\n\n  private stringToSvg(svgString: string) {\n    if (!this._domParser) {\n      return null;\n    }\n    const svg = this._domParser.parseFromString(\n      svgString,\n      'image/svg+xml'\n    ).documentElement;\n\n    if (svg.nodeName !== 'svg') {\n      return null;\n    }\n\n    return svg;\n  }\n}\n", "import { coerceCssPixelValue } from '@angular/cdk/coercion';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  effect,\n  ElementRef,\n  inject,\n  input,\n  Renderer2,\n  signal,\n  untracked,\n} from '@angular/core';\nimport { IconLoaderService } from './icon-loader.service';\n\nconst INITIAL_WIDTH = 24;\nconst INITIAL_HEIGHT = 24;\n\n@Component({\n  selector: 'app-icon',\n  template: '',\n  styles: `\n    :host {\n      display: inline-flex;\n    }\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  host: {\n    role: 'img',\n    '[attr.aria-hidden]': 'true',\n  },\n})\nexport class IconComponent {\n  name = input.required<string>();\n  stretch = input(false);\n  width = input<number | string>(INITIAL_WIDTH);\n  height = input<number | string>(INITIAL_HEIGHT);\n\n  private readonly iconLoaderService = inject(IconLoaderService);\n  private renderer = inject(Renderer2);\n  private host = inject<ElementRef<HTMLElement>>(ElementRef);\n  icon = signal<HTMLElement | undefined>(undefined);\n\n  constructor() {\n    effect(() => {\n      const name = this.name();\n      if (!name) {\n        return;\n      }\n      this.iconLoaderService.load(name).subscribe((icon) => {\n        if (!icon) {\n          return;\n        }\n        untracked(() => {\n          const existingIcon = this.icon();\n          if (existingIcon) {\n            this.renderer.removeChild(this.host.nativeElement, existingIcon);\n          }\n        });\n        this.icon.set(icon);\n        this.renderer.appendChild(this.host.nativeElement, icon);\n      });\n    });\n\n    effect(() => {\n      const icon = this.icon();\n      if (!icon) {\n        return;\n      }\n      if (this.stretch()) {\n        this.renderer.setAttribute(icon, 'width', '100%');\n        this.renderer.setAttribute(icon, 'height', '100%');\n      } else {\n        const coerceWdth = coerceCssPixelValue(this.width());\n        const coerceHeight = coerceCssPixelValue(this.height());\n\n        this.renderer.setAttribute(icon, 'width', coerceWdth);\n        this.renderer.setAttribute(icon, 'height', coerceHeight);\n      }\n    });\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
